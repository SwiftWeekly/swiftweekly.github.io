---
layout: post
title: ! 'Issue #175'
author: fassko
sponsor:
    link: https://swiftpackageindex.com/
    heading:  Swift Package Index
    body: This week’s issue is supported again by Dave Verwer who co-created the Swift Package Index, and publishes iOS Dev Weekly every Friday. He’s been a big advocate for the Weekly Brief since it started, and is supporting it because he wants to see it continue! It’s that simple.
    displaylink: https://swiftpackageindex.com/
---

* async/await in review

<!--excerpt-->

{% include sponsor.html %}

### Starter tasks

> TODO

### Podcasts

In the latest episode of Swift Unwrapped, [Jesse](https://twitter.com/jesse_squires) and [JP](https://twitter.com/simjp) talk [about concurrency](https://spec.fm/podcasts/swift-unwrapped/spdcC97m).

### News and community

[Eneko Alonso](https://twitter.com/eneko) wrote [a blog post](https://www.enekoalonso.com/2020/12/06/getting-started-with-async-await-in-swift.html) explaining how to get started with `async/await` in Swift.

### Commits and pull requests

[Max Desiatov](https://twitter.com/maxdesiatov/) opened [a pull request](https://github.com/apple/swift/pull/34998).

### Accepted proposals

[SE-0291](https://github.com/apple/swift-evolution/blob/main/proposals/0291-package-collections.md): *Package Collections* was [accepted with modifications](https://forums.swift.org/t/accepted-with-modifications-se-0291-package-collections/42622).

> The feedback from the [pitch](https://forums.swift.org/t/package-feeds/) and [first review](https://forums.swift.org/t/se-0291-package-collections/) helped ensure Package Collections are useful and put the Swift packages ecosystem on the right path. During the [first review](https://forums.swift.org/t/se-0291-package-collections/), several community members requested to learn more about the Package Collection data format and the proposal was amended to include this information. The feedback from the [2nd review 8](https://forums.swift.org/t/se-0291-2nd-review-package-collections/42369) was generally positive and the proposal has been accepted with one minor revision: The spelling for the command should be singular (`swift package-collection`) instead of plural (`swift package-collections`).

### Returned proposals

> TODO

### Rejected proposals

> TODO

### Proposals in review

[SE-0296](https://github.com/apple/swift-evolution/blob/main/proposals/0296-async-await.md): *Async/await* is [under a review](https://forums.swift.org/t/se-0296-async-await/42605).

> Modern Swift development involves a lot of asynchronous (or "async") programming using closures and completion handlers, but these APIs are hard to use.  This gets particularly problematic when many asynchronous operations are used, error handling is required, or control flow between asynchronous calls gets complicated.  This proposal describes a language extension to make this a lot more natural and less error prone.

[SE-0292](https://github.com/apple/swift-evolution/blob/main/proposals/0292-package-registry-service.md): *Package Registry Service* is [under a review](https://forums.swift.org/t/se-0292-package-registry-service/42623).

> Swift Package Manager downloads dependencies using Git. Our proposal defines a standard web service interface that it can also use to download dependencies from package registries.

[SE-0297](https://github.com/apple/swift-evolution/blob/main/proposals/0297-concurrency-objc.md): *Concurrency Interoperability with Objective-C* is [under a review](https://forums.swift.org/t/se-0297-concurrency-interoperability-with-objective-c/42702).

> Swift's concurrency feature involves asynchronous functions and actors. While Objective-C does not have corresponding language features, asynchronous APIs are common in Objective-C, expressed manually through the use of completion handlers. This proposal provides bridging between Swift's concurrency features (e.g., `async` functions) and the convention-based expression of asynchronous functions in Objective-C. It is intended to allow the wealth of existing asynchronous Objective-C APIs to be immediately usable with Swift's concurrency model.

### Swift Forums

[Keith Smiley](https://twitter.com/SmileyKeith) started discussion about supporting strict imports.

> We have a large multi-module Swift codebase where we want to support strict imports, meaning files only import what they use, and they import everything they use (not particularly at the class level with import class Foo.bar, but at least import Foo). We have a few specific reasons for wanting this to be enforced:
> 
> 1. When reading a diff it makes it clear when a new dependency on a module is being introduced
> 2. When this is explicitly defined we can enforce what types of modules are allowed to import what other types of modules, for example we don't want modules with business logic importing our UI layer etc
> 3. By trimming unused imports, we can eliminate unnecessary intermodule dependencies, simplifying the dependency graph and speeding up compilation

[Dave Abrahams](https://twitter.com/DaveAbrahams) started [a discussion](https://forums.swift.org/t/long-term-implications-of-async-await-for-the-programming-model/42624) about long-term implications of `async/await` for the programming model.

> This is not dependent on the specifics of any of the proposals under discussion, but I wanted to explore a little bit what the introduction of async/await might mean for the way we program in the long term. I have just two related concerns at this point. I hope the proposers have considered these questions and have some answers, but I'd be interested in anyone's thoughts.

[Doug Gregor](https://twitter.com/dgregor79) [informed](https://forums.swift.org/t/pitch-2-concurrency-interoperability-with-objective-c/42627) about updated pitch for [Concurrency Interoperability with Objective-C](https://github.com/DougGregor/swift-evolution/blob/concurrency-objc/proposals/NNNN-concurrency-objc.md).

> The first [pitch thread](https://forums.swift.org/t/concurrency-interoperability-with-objective-c/41616) provided a bit of feedback, which I've incorporated into this second pitch. The specific changes:

> * Removed mention of asynchronous handlers, which will be in a separate proposal.
> * Introduced the `swift_async_error` Clang attribute to separate out "throwing" behavior from the `swift_async` attribute.
> * Added support for "Swift private" to the `swift_async` attribute.
> * Tuned the naming heuristics based on feedback to add (e.g) `reply` , `replyTo` , `completionBlock` , and variants.
> * For the rare case where we match a parameter suffix, append the text prior to the suffix to the base name.
> * Replaced the `-generateCGImagesAsynchronouslyForTimes:completionHandler:` example with one from PassKit.
> * Added a "Future Directions" section about `NSProgress` .

[Dave Abrahams](https://twitter.com/DaveAbrahams) raised a concern that the rule requiring a `try` label on every potentially-throwing statement was too indiscriminate.

> It's not that requiring a `try` label is always a mistake, I argued—in fact, in _some_ cases being forced to acknowledge a possible throw could be extremely helpful in reasoning about code—it's just that there are so many cases where it wasn't helpful.

[George Barnett](https://twitter.com/glbrntt) asked couple of questions about source location in literals and result builders.

> One issue I've come across recently is the fact that you cannot access the source location of the literal triggering a call to `ExpressibleByFooLiteral`, as `init(fooLiteral value: Foo, file: StaticString = #file)` would fail to fulfill the protocol requirement. There was [a pitch](https://forums.swift.org/t/pitch-allow-functions-with-default-arguments-to-fulfill-protocols/9186/15) quite some time ago to allow functions with default arguments to satisfy protocol requirements, but not much seems to have happened as a result. [Result builders](https://github.com/apple/swift-evolution/blob/main/proposals/0289-result-builders.md) might have a similar problem, as it seems one cannot write `static func buildExpression(..., file: StaticString = #file)`, though since this particular method participates on overload resolution it may just work.

### Finally

[A day in the life of an Apple Engineer](https://twitter.com/NovallSwift/status/1335358897926721539).

[Advent of Code with Swift Argument Parser](https://forums.swift.org/t/parsing-into-a-dictionary-of-int-int/42564).